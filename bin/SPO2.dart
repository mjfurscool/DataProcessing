import 'package:scidart/numdart.dart';
import 'package:scidart/scidart.dart';

List linear_interp(double x1, double y1, double x2, double y2) {
  if (x1 > x2) {
    // keep x1 smaller than x2.
    var t;
    t = x1;
    x1 = x2;
    x2 = t;

    t = y1;
    y1 = y2;
    y2 = t;
  }
  var N = x2 - x1;
  var x;
  var y;
  Array result_y = Array.empty(); //
  for (int i = 0; i < N; i++) {
    x = x1 + i;
    y = (x - x1) * (y2 - y1) / (x2 - x1) + y1;
    result_y.add(y);
  }
  return result_y;
} //

List findtopPeaks(Array a, {double mindistance}) {
  //modify from scidart.findPeaks
  var N = a.length - 2;
  Array ix = Array.empty(); //ix -- index
  Array ax = Array.empty(); // ax -- value
  ix.add(0);
  ax.add(0);
  if (mindistance != null) {
    for (int i = 1; i <= N; i++) {
      if (a[i - 1] <= a[i] && a[i] >= a[i + 1]) {
        if (i - ix.last > mindistance) {
          //mindistance between two peaks
          ix.add(i.toDouble());
          ax.add(a[i]);
        }
      }
    }
  } else {
    for (int i = 1; i <= N; i++) {
      if (a[i - 1] <= a[i] && a[i] >= a[i + 1]) {
        ix.add(i.toDouble());
        ax.add(a[i]);
      }
    }
  }
  ix.remove(0);
  ax.remove(0);
  return [ix, ax];
}

List findlowtroughs(Array a, {double mindistance}) {
  //modify from scidart.findPeaks
  var N = a.length - 2;
  Array ix = Array.empty(); //ix -- index
  Array ax = Array.empty(); // ax -- value
  ix.add(0);
  ax.add(0);
  if (mindistance != null) {
    for (int i = 1; i <= N; i++) {
      if (a[i - 1] >= a[i] && a[i] <= a[i + 1]) {
        if (i - ix.last > mindistance) {
          //mindistance between two peaks
          ix.add(i.toDouble());
          ax.add(a[i]);
        }
      }
    }
  } else {
    for (int i = 1; i <= N; i++) {
      if (a[i - 1] >= a[i] && a[i] <= a[i + 1]) {
        ix.add(i.toDouble());
        ax.add(a[i]);
      }
    }
  }
  ix.remove(0);
  ax.remove(0);
  return [ix, ax];
}

void main() {
  // load RED data -flexboard
  var IR = Array([
    13079,
    13080,
    13117,
    13047,
    13069,
    13041,
    13044,
    13035,
    13027,
    13027,
    13037,
    13078,
    12999,
    12978,
    13039,
    13058,
    13010,
    13001,
    13032,
    13039,
    13002,
    13019,
    13010,
    12987,
    13030,
    13015,
    12994,
    13068,
    13050,
    13048,
    13028,
    13044,
    13047,
    13063,
    13056,
    13048,
    13079,
    13061,
    13029,
    13052,
    13070,
    13053,
    13075,
    13080,
    13066,
    13064,
    13086,
    13035,
    13036,
    13074,
    13048,
    13028,
    13119,
    13077,
    13083,
    13040,
    13054,
    13136,
    13047,
    13054,
    13072,
    13071,
    13081,
    13067,
    13068,
    13023,
    13054,
    13046,
    13065,
    13076,
    13049,
    13071,
    13056,
    13056,
    13057,
    13033,
    13051,
    13061,
    13061,
    13051,
    13062,
    13058,
    13062,
    13051,
    13040,
    13035,
    13063,
    13044,
    13051,
    13057,
    13052,
    13040,
    13053,
    13044,
    13049,
    13056,
    13065,
    13054,
    13055,
    13042,
    13050,
    13059,
    13043,
    13041,
    13039,
    13141,
    13056,
    13049,
    13044,
    13063,
    13122,
    13033,
    13047,
    13068,
    13052,
    13060,
    13048,
    13054,
    13057,
    13028,
    13040,
    13034,
    13042,
    13047,
    13086,
    13053,
    13037,
    13069,
    13090,
    13041,
    13042,
    13048,
    13046,
    13056,
    13042,
    13042,
    13059,
    13045,
    13048,
    13035,
    13095,
    13041,
    13057,
    13058,
    13041,
    13036,
    13047,
    13046,
    13060,
    13039,
    13047,
    13043,
    13038,
    13052,
    13042,
    13043,
    13024,
    13052,
    13037,
    13033,
    13035,
    13036,
    13051,
    13038,
    13042,
    13035,
    13031,
    13039,
    13047,
    13061,
    13031,
    13059,
    13045,
    13035,
    13028,
    13044,
    13043,
    13033,
    13029,
    13053,
    13025,
    13051,
    13044,
    13039,
    13042,
    13047,
    13033,
    13038,
    13049,
    13044,
    13029,
    13032,
    13032,
    13030,
    13036,
    13029,
    13028,
    13037,
    13023,
    13090,
    13034,
    13038,
    13041,
    13030,
    13026,
    13035,
    13051,
    13028,
    13024,
    13021,
    13020,
    13022,
    13011,
    13015,
    13053,
    13037,
    13000,
    13048,
    13023,
    13025,
    13034,
    13017,
    13047,
    13009,
    13025,
    12976,
    13032,
    13034,
    13066,
    12991,
    13025,
    13016,
    12995,
    13067,
    13008,
    13056,
    13123,
    13061,
    13034,
    13042,
    13028,
    13024,
    13005,
    13036,
    13025,
    13036,
    13015,
    13014,
    13064,
    13021,
    13004,
    13015,
    13055,
    13019,
    13019,
    12984,
    13005,
    13008,
    13001,
    13003,
    13002,
    13016,
    12989,
    13009,
    13015,
    13072,
    13008,
    13033,
    13006,
    12987,
    13012,
    13011,
    13000,
    13000,
    12961,
    13005,
    13016,
    12989,
    12993,
    12993,
    12979,
    12995,
    12984,
    13008,
    13053,
    12980,
    12985,
    13064,
    13277,
    12898,
    13067,
    12918,
    12982,
    12949,
    13032,
    12976,
    13035,
    12942,
    12983,
    13003,
    12959,
    12979,
    12995,
    12974,
    13018,
    13001,
    12996,
    12987,
    12988,
    13007,
    13000,
    12985,
    12982,
    12982,
    12991,
    12988,
    13004,
    13004,
    12978,
    13015,
    12987,
    13054,
    13108,
    12978,
    12978,
    13040,
    12966,
    12975,
    13030,
    13007,
    12988,
    12978,
    13007,
    12995,
    12971,
    12986,
    12979,
    12975,
    13026,
    13004,
    12978,
    13015,
    12994,
    12976,
    12967,
    13232,
    13036,
    13069,
    12908,
    13040,
    12988,
    12988,
    12960,
    13009,
    13004,
    12970,
    13026,
    13016,
    13012,
    12983,
    12994,
    13001,
    13003,
    13001,
    12984,
    12992,
    12998,
    12981,
    12969,
    12983,
    12990,
    13027,
    12991,
    12987,
    12970,
    13007,
    12913,
    12994,
    13027,
    12988,
    12981,
    13000,
    12999,
    12992,
    12973,
    12987,
    13099,
    12980,
    12989,
    12991,
    12981,
    13004,
    12990,
    12981,
    13004,
    12968,
    12973,
    12997,
    12987,
    13001,
    12976,
    12978,
    12970,
    12984,
    13007,
    12992,
    12982,
    12998,
    12962,
    12933,
    12974,
    12962,
    12977,
    12970,
    12982,
    12988,
    13058,
    12972,
    12979,
    12977,
    13017,
    12971,
    12988,
    12970,
    12956,
    12980,
    12980,
    12982,
    12981,
    12973,
    12974,
    12968,
    12981,
    12964,
    12986,
    13064,
    12980,
    12973,
    12974,
    12976,
    12985,
    12976,
    12980,
    12970,
    12970,
    12986,
    12981,
    12962,
    12980,
    12978,
    13021,
    13009,
    12958,
    12975,
    12957,
    12985,
    12969,
    12981,
    12955,
    12968,
    12979,
    12960,
    12966,
    12970,
    13060,
    12962,
    12977,
    12957,
    12980,
    12973,
    12964,
    12965,
    12955,
    12974,
    12957,
    12966,
    12986,
    12980,
    12990,
    12973,
    12953,
    12983,
    12970,
    12984,
    12922,
    12943,
    12937,
    12959,
    12946,
    12937,
    12932,
    12895,
    12888,
    12888,
    12823,
    12920,
    12809,
    12996,
    12846,
    12956,
    12863,
    12897,
    12845,
    12836,
    12851,
    12903,
    12895,
    12809,
    12885,
    12878,
    12896,
    12922,
    12907,
    12926,
    12916,
    12928,
    12946,
    12917,
    12961,
    12941,
    12941,
    12943,
    12954,
    12939,
    12969,
    12939,
    12970,
    12949,
    12952,
    12950,
    12893,
    12935,
    12948,
    12958,
    12941,
    12975,
    12955,
    12954,
    12947,
    12947,
    12958,
    12962,
    12940,
    13066,
    12932,
    12944,
    12924,
    12941,
    12913,
    12941,
    12948,
    12947,
    12950,
    12941,
    12935,
    12972,
    12953,
    13029,
    12936,
    12950,
    12929,
    12991,
    12959,
    12939,
    12946,
    12972,
    12970,
    12950,
    12967,
    12937,
    12926,
    12943,
    12946,
    12945,
    13002,
    12940,
    12968,
    12962,
    13022,
    12942,
    12946,
    12961,
    12886,
    12930,
    12947,
    12936,
    12946,
    12970,
    12965,
    12972,
    13019,
    12946,
    12941,
    12972,
    12949,
    12919,
    12960,
    12932,
    12915,
    12955,
    12949,
    12943,
    12962,
    12948,
    12954,
    12943,
    12945,
    12947,
    12946,
    12942,
    12932,
    12952,
    12938,
    12928,
    12920,
    12933,
    12936,
    12943,
    12982,
    12936,
    12923,
    12960,
    12950,
    12933,
    12949,
    12948,
    12916,
    12956,
    12930,
    12926,
    12931,
    12917,
    12937,
    12936,
    12924,
    12901,
    12934,
    12922,
    12933,
    12942,
    12915,
    12963,
    12915,
    12940,
    12957,
    12936,
    12920,
    12937,
    12966,
    12934,
    12961,
    12923,
    12926,
    12920,
    12950,
    12919,
    12910,
    12952,
    12939,
    12888,
    12944,
    12930,
    12926,
    12931,
    12961,
    12914,
    12920,
    12980,
    12935,
    12915,
    12927,
    12901,
    12924,
    12917,
    12918,
    12890,
    12887,
    12909,
    12877,
    12885,
    12865,
    12956,
    12882,
    12802,
    12890,
    12928,
    12936,
    12904,
    12906,
    12916,
    12921,
    13017,
    12919,
    12902,
    12911,
    12828,
    12915,
    12905,
    12917,
    12930,
    12909,
    12925,
    12909,
    12983,
    12892,
    12931,
    12972,
    12937,
    12917,
    12926,
    12921,
    12897,
    12921,
    12920,
    12913,
    12916,
    12906,
    12922,
    12909,
    12927,
    12928,
    12929,
    12920,
    12902,
    12924,
    12902,
    12919,
    12892,
    12918,
    12905,
    12915,
    12903,
    12913,
    12961,
    12894,
    12907,
    12922,
    12906,
    12918,
    12928,
    12924,
    12906,
    12916,
    12919,
    12969,
    12879,
    12899,
    12905,
    12891,
    12915,
    12877,
    12898,
    12883,
    12894,
    12895,
    12900,
    12908,
    12904,
    12955,
    12910,
    12905,
    12897,
    12907,
    12911,
    12892,
    12896,
    12892,
    12878,
    12895,
    12884,
    12911,
    12904,
    12891,
    12949,
    12876,
    12888,
    12894,
    12910,
    12870,
    12873,
    12876,
    12906,
    12901,
    12926,
    12907,
    12904,
    12914,
    12880,
    12974,
    12904,
    12900,
    12902,
    12914,
    12868,
    12894,
    12916,
    12917,
    12889,
    12880,
    12902,
    12888,
    12866,
    12863,
    12885,
    12846,
    12889,
    12852,
    12828,
    12868,
    12844,
    12871,
    12890,
    12872,
    12872,
    12842,
    12880,
    12859,
    12927,
    12895,
    12887,
    12872,
    12890,
    12881,
    12879,
    12868,
    12914,
    12887,
    12907,
    12902,
    12936,
    12863,
    12875,
    12894,
    12896,
    12905,
    12908,
    12899,
    12901,
    12909,
    12915,
    12915,
    12916,
    12893,
    12904,
    12963,
    12882,
    12965,
    12883,
    12923,
    12855,
    12884,
    12896,
    12906,
    12880,
    12897,
    12887,
    12908,
    12893,
    12971,
    12879,
    12876,
    12887,
    12896,
    12893,
    12895,
    12896,
    12892,
    12914,
    12896,
    12927,
    12896,
    12929,
    12897,
    12907,
    12876,
    12886,
    12882,
    12898,
    12885,
    12893,
    12900,
    12899,
    12906,
    12894,
    12903,
    12898,
    12896,
    12881,
    12914,
    12910,
    12909,
    12906,
    12906,
    12908,
    12913,
    12902,
    12923,
    12893,
    12901,
    12903,
    12981,
    12913,
    12900,
    12912,
    12908,
    12902,
    12900,
    12905,
    12885,
    12889,
    12887,
    12899,
    12903,
    12894,
    12891,
    12891,
    12904,
    12904,
    12887,
    12854,
    12899,
    12897,
    12887,
    12957,
    12897,
    12901,
    12887,
    12901,
    12900,
    12890,
    12895,
    12890,
    12889,
    12902,
    12905,
    12885,
    12897,
    12903,
    12899,
    12909,
    12884,
    12884,
    12902,
    12901,
    12894,
    12887,
    12890,
    12900,
    12880,
    12899,
    12879,
    12907,
    12918,
    12884,
    12898,
    12896,
    12871,
    12903,
    12898,
    12900,
    12865,
    12885,
    12881,
    12881,
    12889,
    12880,
    12866,
    12938,
    12875,
    12871,
    12863,
    12888,
    12886,
    12860,
    12860,
    12838,
    12871,
    12867,
    12842,
    12833,
    12845,
    12852,
    12868,
    12857,
    12861,
    12845,
    12875,
    12864,
    12820,
    12832,
    12889,
    12869,
    12863,
    12872,
    12875,
    12878,
    12874,
    12802,
    12894,
    12896,
    12902,
  ]);
  var RED = Array([
    51746,
    51740,
    51708,
    51810,
    51734,
    51724,
    51701,
    51696,
    51698,
    51706,
    51716,
    51657,
    51681,
    51681,
    51712,
    51687,
    51691,
    51694,
    51690,
    51718,
    51713,
    51708,
    51703,
    51700,
    51707,
    51747,
    51687,
    51702,
    51717,
    51654,
    51721,
    51733,
    51727,
    51741,
    51831,
    51726,
    51748,
    51735,
    51697,
    51632,
    51723,
    51736,
    51734,
    51728,
    51738,
    51731,
    51685,
    51729,
    51719,
    51724,
    51737,
    51721,
    51757,
    51736,
    51735,
    51721,
    51723,
    51692,
    51728,
    51750,
    51736,
    51739,
    51814,
    51720,
    51731,
    51764,
    51778,
    51723,
    51738,
    51731,
    51723,
    51786,
    51743,
    51722,
    51722,
    51715,
    51724,
    51728,
    51726,
    51712,
    51719,
    51724,
    51716,
    51715,
    51717,
    51725,
    51710,
    51723,
    51725,
    51706,
    51735,
    51712,
    51729,
    51720,
    51722,
    51724,
    51738,
    51741,
    51706,
    51734,
    51707,
    51719,
    51718,
    51719,
    51714,
    51738,
    51732,
    51713,
    51725,
    51741,
    51628,
    51818,
    51702,
    51736,
    51757,
    51720,
    51697,
    51726,
    51710,
    51732,
    51709,
    51710,
    51713,
    51709,
    51609,
    51717,
    51713,
    51712,
    51660,
    51775,
    51710,
    51719,
    51699,
    51711,
    51669,
    51713,
    51720,
    51704,
    51713,
    51714,
    51740,
    51704,
    51704,
    51710,
    51707,
    51776,
    51713,
    51720,
    51724,
    51771,
    51699,
    51716,
    51705,
    51710,
    51677,
    51696,
    51711,
    51708,
    51703,
    51723,
    51708,
    51765,
    51720,
    51697,
    51702,
    51687,
    51700,
    51706,
    51705,
    51708,
    51729,
    51682,
    51700,
    51597,
    51697,
    51710,
    51725,
    51786,
    51697,
    51710,
    51704,
    51680,
    51708,
    51694,
    51692,
    51693,
    51705,
    51715,
    51708,
    51687,
    51697,
    51692,
    51752,
    51703,
    51707,
    51700,
    51701,
    51720,
    51707,
    51566,
    51707,
    51704,
    51828,
    51680,
    51687,
    51685,
    51763,
    51689,
    51688,
    51690,
    51695,
    51698,
    51679,
    51705,
    51714,
    51709,
    51686,
    51684,
    51681,
    51679,
    51682,
    51662,
    51663,
    51689,
    51691,
    51712,
    51715,
    51690,
    51723,
    51680,
    51691,
    51683,
    51690,
    51723,
    51677,
    51708,
    51596,
    51700,
    51707,
    51753,
    51710,
    51689,
    51691,
    51691,
    51687,
    51685,
    51690,
    51692,
    51714,
    51682,
    51673,
    51684,
    51626,
    51711,
    51688,
    51706,
    51742,
    51678,
    51660,
    51668,
    51693,
    51679,
    51668,
    51674,
    51679,
    51653,
    51687,
    51680,
    51695,
    51689,
    51774,
    51677,
    51672,
    51667,
    51730,
    51739,
    51667,
    51669,
    51660,
    51658,
    51670,
    51674,
    51667,
    51674,
    51571,
    51674,
    51672,
    51672,
    52015,
    51609,
    51734,
    51639,
    51679,
    51637,
    51681,
    51677,
    51711,
    51655,
    51663,
    51684,
    51632,
    51667,
    51678,
    51656,
    51707,
    51694,
    51681,
    51661,
    51684,
    51675,
    51665,
    51672,
    51683,
    51663,
    51677,
    51666,
    51785,
    51671,
    51672,
    51686,
    51672,
    51735,
    51700,
    51657,
    51645,
    51708,
    51636,
    51652,
    51693,
    51731,
    51708,
    51672,
    51676,
    51670,
    51656,
    51669,
    51665,
    51667,
    51687,
    51679,
    51667,
    51686,
    51667,
    51755,
    51664,
    51820,
    51698,
    51805,
    51591,
    51699,
    51674,
    51667,
    51634,
    51725,
    51678,
    51634,
    51685,
    51685,
    51693,
    51674,
    51671,
    51674,
    51727,
    51664,
    51661,
    51671,
    51654,
    51670,
    51650,
    51666,
    51671,
    51618,
    51677,
    51685,
    51673,
    51670,
    51651,
    51673,
    51711,
    51680,
    51676,
    51681,
    51662,
    51668,
    51656,
    51659,
    51561,
    51660,
    51658,
    51687,
    51661,
    51710,
    51753,
    51655,
    51674,
    51663,
    51650,
    51673,
    51669,
    51655,
    51663,
    51666,
    51654,
    51663,
    51636,
    51679,
    51648,
    51660,
    51659,
    51692,
    51713,
    51661,
    51651,
    51641,
    51655,
    51662,
    51629,
    51662,
    51648,
    51632,
    51650,
    51723,
    51659,
    51662,
    51703,
    51687,
    51655,
    51645,
    51659,
    51648,
    51693,
    51658,
    51654,
    51657,
    51653,
    51571,
    51659,
    51658,
    51796,
    51636,
    51658,
    51650,
    51655,
    51653,
    51658,
    51642,
    51670,
    51639,
    51646,
    51647,
    51584,
    51678,
    51646,
    51663,
    51637,
    51659,
    51642,
    51642,
    51645,
    51673,
    51655,
    51652,
    51643,
    51666,
    51600,
    51643,
    51662,
    51646,
    51638,
    51701,
    51715,
    51645,
    51645,
    51647,
    51650,
    51703,
    51651,
    51651,
    51666,
    51658,
    51627,
    51680,
    51637,
    51632,
    51623,
    51634,
    51616,
    51636,
    51634,
    51624,
    51616,
    51577,
    51592,
    51582,
    51545,
    51588,
    51522,
    51663,
    51542,
    51659,
    51566,
    51589,
    51554,
    51498,
    51614,
    51568,
    51675,
    51489,
    51558,
    51581,
    51572,
    51649,
    51615,
    51606,
    51626,
    51629,
    51646,
    51631,
    51646,
    51621,
    51723,
    51625,
    51643,
    51599,
    51664,
    51632,
    51605,
    51647,
    51632,
    51639,
    51607,
    51657,
    51622,
    51633,
    51629,
    51668,
    51719,
    51650,
    51641,
    51657,
    51628,
    51640,
    51646,
    51553,
    51637,
    51616,
    51621,
    51628,
    51650,
    51617,
    51625,
    51634,
    51641,
    51629,
    51648,
    51646,
    51639,
    51610,
    51632,
    51663,
    51620,
    51666,
    51629,
    51636,
    51645,
    51647,
    51666,
    51636,
    51630,
    51644,
    51614,
    51703,
    51627,
    51621,
    51624,
    51647,
    51640,
    51650,
    51560,
    51634,
    51628,
    51641,
    51634,
    51626,
    51615,
    51645,
    51614,
    51641,
    51654,
    51649,
    51561,
    51621,
    51614,
    51640,
    51630,
    51586,
    51682,
    51643,
    51611,
    51695,
    51674,
    51643,
    51631,
    51625,
    51670,
    51639,
    51624,
    51629,
    51627,
    51641,
    51629,
    51633,
    51621,
    51614,
    51602,
    51613,
    51633,
    51624,
    51572,
    51627,
    51612,
    51626,
    51638,
    51640,
    51636,
    51636,
    51604,
    51631,
    51631,
    51660,
    51635,
    51622,
    51632,
    51672,
    51611,
    51617,
    51619,
    51626,
    51644,
    51623,
    51621,
    51557,
    51601,
    51615,
    51640,
    51634,
    51597,
    51622,
    51627,
    51631,
    51644,
    51623,
    51610,
    51615,
    51641,
    51612,
    51589,
    51564,
    51688,
    51663,
    51595,
    51630,
    51623,
    51623,
    51657,
    51610,
    51607,
    51557,
    51627,
    51607,
    51614,
    51609,
    51618,
    51596,
    51612,
    51595,
    51586,
    51607,
    51576,
    51577,
    51559,
    51499,
    51570,
    51552,
    51595,
    51607,
    51652,
    51609,
    51599,
    51611,
    51608,
    51548,
    51609,
    51607,
    51602,
    51628,
    51604,
    51611,
    51604,
    51535,
    51595,
    51615,
    51597,
    51661,
    51624,
    51617,
    51610,
    51625,
    51615,
    51608,
    51624,
    51643,
    51611,
    51621,
    51615,
    51598,
    51601,
    51623,
    51612,
    51615,
    51589,
    51617,
    51623,
    51614,
    51613,
    51590,
    51603,
    51592,
    51597,
    51588,
    51606,
    51590,
    51623,
    51576,
    51611,
    51590,
    51617,
    51606,
    51590,
    51605,
    51607,
    51599,
    51598,
    51594,
    51593,
    51583,
    51601,
    51600,
    51640,
    51602,
    51585,
    51571,
    51653,
    51569,
    51588,
    51583,
    51591,
    51588,
    51524,
    51609,
    51604,
    51605,
    51643,
    51616,
    51588,
    51600,
    51596,
    51589,
    51594,
    51603,
    51586,
    51606,
    51578,
    51623,
    51538,
    51635,
    51579,
    51599,
    51582,
    51583,
    51582,
    51601,
    51592,
    51654,
    51591,
    51598,
    51596,
    51589,
    51505,
    51600,
    51593,
    51589,
    51610,
    51584,
    51605,
    51600,
    51588,
    51604,
    51563,
    51590,
    51578,
    51575,
    51574,
    51569,
    51564,
    51555,
    51544,
    51554,
    51561,
    51570,
    51640,
    51593,
    51576,
    51556,
    51573,
    51572,
    51559,
    51523,
    51582,
    51573,
    51579,
    51579,
    51585,
    51667,
    51581,
    51586,
    51594,
    51584,
    51591,
    51636,
    51587,
    51592,
    51607,
    51590,
    51487,
    51610,
    51587,
    51652,
    51604,
    51595,
    51578,
    51609,
    51600,
    51615,
    51512,
    51569,
    51556,
    51690,
    51597,
    51631,
    51622,
    51591,
    51596,
    51581,
    51586,
    51601,
    51595,
    51585,
    51524,
    51586,
    51586,
    51595,
    51590,
    51608,
    51623,
    51587,
    51589,
    51585,
    51586,
    51606,
    51586,
    51544,
    51671,
    51602,
    51546,
    51577,
    51641,
    51588,
    51600,
    51596,
    51588,
    51587,
    51589,
    51599,
    51592,
    51591,
    51586,
    51586,
    51604,
    51604,
    51584,
    51629,
    51588,
    51585,
    51581,
    51605,
    51633,
    51597,
    51594,
    51585,
    51524,
    51588,
    51607,
    51602,
    51730,
    51592,
    51582,
    51574,
    51596,
    51593,
    51590,
    51608,
    51597,
    51586,
    51590,
    51591,
    51576,
    51609,
    51595,
    51599,
    51576,
    51582,
    51576,
    51578,
    51592,
    51585,
    51579,
    51642,
    51585,
    51576,
    51598,
    51608,
    51579,
    51585,
    51589,
    51568,
    51591,
    51573,
    51574,
    51595,
    51598,
    51581,
    51586,
    51589,
    51591,
    51616,
    51576,
    51527,
    51589,
    51610,
    51583,
    51591,
    51579,
    51611,
    51587,
    51599,
    51583,
    51653,
    51590,
    51583,
    51568,
    51576,
    51637,
    51573,
    51573,
    51577,
    51585,
    51511,
    51576,
    51565,
    51562,
    51673,
    51565,
    51577,
    51552,
    51554,
    51558,
    51561,
    51555,
    51552,
    51548,
    51559,
    51565,
    51553,
    51541,
    51564,
    51622,
    51558,
    51530,
    51551,
    51569,
    51569,
    51567,
    51570,
    51579,
    51558,
    51575,
    51574,
    51595,
    51572,
    51591
  ]);

  // load RED data - normal board
  var sg_IR = Array([
    3968,
    3882,
    3971,
    3981,
    3974,
    3970,
    3976,
    3950,
    3967,
    3960,
    3962,
    3967,
    3962,
    3977,
    3978,
    3968,
    3971,
    4088,
    3973,
    3959,
    4053,
    3959,
    3961,
    3975,
    3975,
    3967,
    3970,
    3974,
    3982,
    3939,
    3962,
    3969,
    3977,
    3973,
    3972,
    4044,
    3965,
    3969,
    3973,
    4020,
    3949,
    3949,
    4078,
    3953,
    3955,
    4032,
    3963,
    3954,
    3949,
    3969,
    3977,
    3989,
    3965,
    3964,
    3972,
    3874,
    3951,
    3952,
    3975,
    3976,
    3979,
    3957,
    3969,
    3956,
    3864,
    3949,
    3955,
    3967,
    3966,
    3953,
    4003,
    3971,
    3962,
    3955,
    3997,
    3967,
    3954,
    3957,
    3950,
    3974,
    3965,
    3964,
    3980,
    4032,
    3962,
    3979,
    3975,
    3952,
    3968,
    4013,
    3967,
    3962,
    3927,
    3973,
    3953,
    4003,
    3967,
    3957,
    3975,
    4012,
    3949,
    4108,
    4041,
    3953,
    3975,
    4043,
    3978,
    3963,
    3964,
    4050,
    3965,
    3964,
    4024,
    3968,
    3961,
    3961,
    3854,
    3972,
    3964,
    3962,
    3956,
    3955,
    3963,
    3966,
    3964,
    3954,
    3875,
    3965,
    3961,
    3967,
    3972,
    3949,
    3966,
    3974,
    3962,
    3966,
    3975,
    3959,
    3952,
    3960,
    3967,
    3961,
    3967,
    3955,
    3961,
    3962,
    3949,
    4045,
    3976,
    3967,
    3963,
    3962,
    3952,
    3972,
    3950,
    3960,
    4021,
    3963,
    3970,
    3961,
    3950,
    3974,
    4032,
    3952,
    3958,
    3965,
    4026,
    3951,
    3959,
    3966,
    3955,
    3945,
    4057,
    3962,
    3957,
    4025,
    3961,
    3961,
    4017,
    3984,
    3959,
    3955,
    3947,
    3961,
    3957,
    3958,
    3944,
    3856,
    3964,
    3948,
    3854,
    3944,
    3962,
    3946,
    3962,
    3960,
    3944,
    3950,
    3963,
    3959,
    3976,
    3957,
    3959,
    3956,
    3953,
    3961,
    4059,
    3967,
    3952,
    3956,
    4048,
    3961,
    3956,
    3948,
    3960,
    3957,
    3960,
    3955,
    3953,
    3985,
    3982,
    3926,
    3953,
    3964,
    3933,
    3929,
    3942,
    3979,
    3948,
    3951,
    4032,
    3939,
    3950,
    4049,
    3942,
    3962,
    4034,
    3952,
    3956,
    4019,
    3968,
    3953,
    3937,
    3983,
    3938,
    3935,
    3945,
    3988,
    3953,
    3929,
    3952,
    3948,
    3948,
    3954,
    3940,
    3949,
    3954,
    3956,
    3828,
    3932,
    3954,
    3858,
    3931,
    3945,
    3945,
    3948,
    3953,
    3958,
    3893,
    3939,
    3930,
    3952,
    3967,
    3936,
    3939,
    3952,
    4044,
    3937,
    4029,
    3947,
    3942,
    4017,
    3947,
    3947,
    3944,
    3953,
    3943,
    3938,
    3954,
    3934,
    3932,
    3941,
    3932,
    3948,
    3993,
    3948,
    3940,
    4024,
    3933,
    3946,
    4025,
    3939,
    3938,
    4055,
    3948,
    3944,
    3956,
    4017,
    3956,
    3949,
    3974,
    3949,
    3940,
    3904,
    3946,
    3940,
    3942,
    3883,
    3952,
    3941,
    3928,
    3935,
    3936,
    3944,
    3865,
    3932,
    3937,
    3947,
    3853,
    3945,
    3947,
    3941,
    3938,
    3940,
    3939,
    3941,
    3934,
    3950,
    3955,
    3941,
    3952,
    3950,
    3954,
    3954,
    3938,
    4030,
    3950,
    3942,
    3946,
    4015,
    3940,
    3956,
    3947,
    3935,
    3950,
    3941,
    3984,
    3941,
    3956,
    3944,
    3947,
    3941,
    3941,
    3944,
    3944,
    3941,
    3944,
    3938,
    4032,
    4028,
    3958,
    3952,
    4069,
    3943,
    3944,
    3952,
    4056,
    3945,
    3940,
    4013,
    4014,
    3943,
    3935,
    3949,
    3951,
    3952,
    3955,
    3957,
    3935,
    3903,
    3946,
    3949,
    3939,
    3850,
    3953,
    3940,
    3947,
    3956,
    3927,
    3943,
    3871,
    3951,
    3944,
    3943,
    3836,
    3946,
    3936,
    3954,
    3951,
    3946,
    3948,
    3901,
    3945,
    3943,
    3940,
    3970,
    3946,
    3952,
    3951,
    3944,
    3943,
    3935,
    4019,
    3936,
    3927,
    3939,
    4002,
    3953,
    3952,
    3991,
    3945,
    3941,
    3942,
    3940,
    3951,
    3940,
    3964,
    3939,
    3945,
    3984,
    3916,
    3957,
    3950,
    4016,
    3943,
    3938,
    3948,
    4037,
    3945,
    4043,
    3938,
    3937,
    3949,
    4024,
    3944,
    3933,
    3949,
    4007,
    3948,
    3975,
    3936,
    3946,
    3932,
    3841,
    3934,
    3939,
    3842,
    3957,
    3942,
    3840,
    3944,
    3943,
    3932,
    3854,
    3956,
    3945,
    3940,
    3924,
    3931,
    3937,
    3953,
    3939,
    3952,
    3934,
    4019,
    3937,
    3942,
    3931,
    3944,
    3928,
    3933,
    3986,
    3941,
    3947,
    3965,
    3942,
    3942,
    3946,
    3941,
    3936,
    3915,
    3940,
    3934,
    3971,
    3946,
    3939,
    3941,
    4006,
    3935,
    3941,
    3964,
    3946,
    3940,
    4059,
    4083,
    3942,
    3943,
    4004,
    3938,
    3946,
    3936,
    3965,
    3950,
    3986,
    3972,
    3935,
    3937,
    3845,
    3949,
    3929,
    3930,
    3947,
    3938,
    3839,
    3937,
    3927,
    3828,
    3939,
    3943,
    3942,
    3945,
    3938,
    3936,
    3957,
    3936,
    3922,
    3960,
    3928,
    3936,
    3952,
    3946,
    3952,
    3936,
    4042,
    3942,
    3938,
    3979,
    3935,
    3937,
    3934,
    3941,
    3935,
    3938,
    3939,
    3935,
    3944,
    3945,
    3937,
    3969,
    3938,
    3938,
    3944,
    3997,
    3938,
    4066,
    4028,
    3938,
    3940,
    4044,
    3921,
    3940,
    4054,
    3934,
    3947,
    4004,
    3948,
    3947,
    3899,
    3948,
    3932,
    3934,
    3947,
    3943,
    3941,
    3945,
    3935,
    3935,
    3933,
    3813,
    3944,
    3933,
    3931,
    3941,
    3934,
    3939,
    3936,
    3938,
    3934,
    3943,
    3942,
    3929,
    3950,
    3949,
    3938,
    3934,
    3948,
    3934,
    3931,
    4002,
    3933,
    3938,
    3926,
    3946,
    3944,
    3929,
    3944,
    3940,
    3937,
    4038,
    3949,
    3930,
    3912,
    3980,
    3940,
    3942,
    3982,
    3941,
    3947,
    3937,
    4051,
    3939,
    3955,
    4085,
    4062,
    3933,
    3942,
    4030,
    3941,
    3937,
    3928,
    3985,
    3932,
    3931,
    3908,
    3968,
    3937,
    3940,
    3934,
    3943,
    3938,
    3939,
    3931,
    3933,
    3938,
    3830,
    3951,
    3940,
    3871,
    3930,
    3938,
    3956,
    3943,
    3946,
    3936,
    3930,
    3948,
    3949,
    3969,
    3936,
    3928,
    3939,
    3943,
    3930,
    3933,
    4047,
    3932,
    3923,
    3931,
    3982,
    3940,
    3953,
    3947,
    3944,
    3941,
    3903,
    3932,
    3929,
    4004,
    3936,
    3924,
    3934,
    3946,
    3923,
    4047,
    3934,
    3944,
    4049,
    4023,
    3931,
    3933,
    3940,
    3937,
    3933,
    4056,
    3930,
    3928,
    3946,
    3987,
    3942,
    3972,
    3939,
    3942,
    3939,
    3920,
    3937,
    3935,
    3861,
    3935,
    3931,
    3859,
    3935,
    3934,
    3926,
    3918,
    3934,
    3943,
    3850,
    3927,
    3939,
    3913,
    3939,
    3936,
    3936,
    3933,
    3932,
    3920,
    3935,
    3914,
    3922,
    4029,
    3929,
    3931,
    3934,
    3934,
    3938,
    3940,
    4036,
    3940,
    3935,
    3929,
    3958,
    3943,
    3939,
    3934,
    3951,
    3923,
    3936,
    3946,
    3943,
    3925,
    3976,
    3939,
    3934,
    4011,
    3927,
    3938,
    3933,
    4066,
    3940,
    3937,
    3939,
    4078,
    3923,
    3931,
    3973,
    3938,
    3954,
    3931,
    4004,
    3941,
    3938,
    3936,
    3927,
    3923,
    3930,
    3847,
    3933,
    3926,
    3945,
    3856,
    3945,
    3935,
    3940,
    3937,
    3939,
    3936,
    3845,
    3936,
    3942,
    3936,
    3928,
    3932,
    3938,
    3937,
    3923,
    3942,
    3928,
    3930,
    3988,
    3935,
    3926,
    3942,
    4050,
    3929,
    3936,
    3953,
    3930,
    3931,
    3933,
    3985,
    3941,
    3931,
    3984,
    3924,
    3932,
    3919,
    3942,
    3928,
    3932,
    3935,
    3946,
    3939,
    3981,
    4009,
    3933,
    3939,
    4030,
    3942,
    3941,
    4052,
    3937,
    3943,
    4027,
    3948,
    3928,
    3936,
    3961,
    3989,
    3942,
    3928,
    4003,
    3929,
    3955,
    3946,
    3931,
    3935,
    3939,
    3852,
    3927,
    3938,
    3935,
    3933,
    3941,
    3931,
    3945,
    3853,
    3933,
    3935,
    3942,
    3863,
    3934,
    3933,
    3943,
    3936,
    3937,
    3938,
    3942,
    3935,
    3944,
    3926,
    3979,
    3928,
    3936,
    3928,
    3931,
    3938,
    3936,
    4039,
    3942,
    3930,
    3975,
    3939,
    3927,
    3934,
    3934,
    3944,
    3926,
    3981,
    3944,
    3932,
    3943,
    4017,
    3935,
    3943,
    3960,
    3939,
    3927,
    3935,
    3997,
    3933,
    3942,
    3939,
    3971,
    3940,
    3927,
    4054,
    3935,
    3931,
    3946,
    4006,
    3938,
    3929,
    3934,
    3968,
    3934,
    3932,
    3929,
    3913,
    3937,
    3876,
    3925,
    3931,
    3929,
    3925,
    3938,
    3938,
    3937,
    3934,
    3930,
    3855,
    3946,
    3942,
    3931,
    3941,
    3925,
    3933,
    3904,
    3921,
    3931,
    3936,
    3936,
    3923,
    3921,
    3939,
    3944,
    3929,
    3932,
    4009,
    3923,
    3944,
    3923,
    4015,
    3931,
    3941,
    3933,
    3928,
    3923,
    3997,
    3922,
    3923,
    3931,
    3961,
    3937,
    3926,
    3969,
    3945,
    3922,
    3940,
    4027,
    3933,
    3971,
    3938,
    3924,
    4037,
    3941,
    3914,
    3957,
    3933,
    3932,
    3974,
    3971,
  ]);
  var sg_RED = Array([
    6854,
    6925,
    6845,
    6850,
    6837,
    6835,
    6852,
    6841,
    6835,
    6844,
    6906,
    6855,
    6842,
    6851,
    6852,
    6844,
    6849,
    6845,
    6847,
    6845,
    6837,
    6843,
    6856,
    6826,
    6836,
    6857,
    6847,
    6847,
    6841,
    6852,
    6842,
    6840,
    6846,
    6859,
    6838,
    6937,
    6838,
    6841,
    6851,
    6856,
    6804,
    6809,
    6903,
    6823,
    6816,
    6894,
    6808,
    6817,
    6812,
    6771,
    6851,
    6846,
    6846,
    6847,
    6841,
    6864,
    6824,
    6834,
    6843,
    6834,
    6847,
    6829,
    6821,
    6837,
    6958,
    6821,
    6819,
    6828,
    6832,
    6827,
    6854,
    6828,
    6840,
    6827,
    6838,
    6833,
    6832,
    6837,
    6812,
    6825,
    6821,
    6831,
    6833,
    6834,
    6837,
    6840,
    6836,
    6824,
    6844,
    6829,
    6832,
    6837,
    6836,
    6846,
    6828,
    6858,
    6825,
    6816,
    6823,
    6839,
    6826,
    6899,
    6840,
    6827,
    6823,
    6893,
    6833,
    6835,
    6827,
    6835,
    6833,
    6838,
    6870,
    6839,
    6829,
    6820,
    6859,
    6823,
    6831,
    6824,
    6825,
    6817,
    6826,
    6830,
    6829,
    6832,
    6888,
    6840,
    6825,
    6828,
    6824,
    6824,
    6829,
    6837,
    6830,
    6844,
    6815,
    6814,
    6826,
    6829,
    6821,
    6837,
    6834,
    6830,
    6819,
    6818,
    6824,
    6819,
    6829,
    6835,
    6824,
    6823,
    6837,
    6824,
    6818,
    6854,
    6826,
    6822,
    6828,
    6829,
    6822,
    6828,
    6912,
    6822,
    6823,
    6815,
    6827,
    6810,
    6825,
    6832,
    6818,
    6814,
    6855,
    6820,
    6821,
    6820,
    6820,
    6818,
    6826,
    6825,
    6821,
    6814,
    6809,
    6835,
    6816,
    6828,
    6819,
    6889,
    6828,
    6810,
    6929,
    6827,
    6830,
    6841,
    6830,
    6827,
    6856,
    6812,
    6821,
    6825,
    6831,
    6821,
    6821,
    6817,
    6836,
    6821,
    6817,
    6821,
    6821,
    6802,
    6815,
    6814,
    6822,
    6822,
    6809,
    6827,
    6829,
    6825,
    6809,
    6865,
    6831,
    6770,
    6811,
    6840,
    6786,
    6794,
    6809,
    6794,
    6802,
    6796,
    6900,
    6797,
    6800,
    6893,
    6788,
    6808,
    6794,
    6795,
    6806,
    6846,
    6758,
    6827,
    6773,
    6833,
    6782,
    6798,
    6792,
    6791,
    6797,
    6763,
    6798,
    6778,
    6803,
    6797,
    6792,
    6824,
    6803,
    6801,
    6849,
    6766,
    6813,
    6950,
    6787,
    6793,
    6802,
    6788,
    6797,
    6791,
    6799,
    6793,
    6801,
    6798,
    6792,
    6792,
    6805,
    6795,
    6797,
    6778,
    6793,
    6800,
    6801,
    6790,
    6788,
    6797,
    6794,
    6793,
    6781,
    6784,
    6787,
    6777,
    6783,
    6780,
    6796,
    6806,
    6819,
    6799,
    6804,
    6806,
    6784,
    6797,
    6800,
    6798,
    6800,
    6851,
    6803,
    6789,
    6791,
    6852,
    6782,
    6790,
    6806,
    6800,
    6792,
    6804,
    6787,
    6792,
    6797,
    6834,
    6799,
    6801,
    6796,
    6791,
    6796,
    6805,
    6889,
    6802,
    6811,
    6800,
    6921,
    6799,
    6780,
    6797,
    6804,
    6796,
    6847,
    6798,
    6796,
    6791,
    6806,
    6786,
    6794,
    6794,
    6796,
    6797,
    6805,
    6795,
    6789,
    6813,
    6793,
    6789,
    6780,
    6797,
    6795,
    6804,
    6796,
    6787,
    6803,
    6813,
    6799,
    6795,
    6798,
    6805,
    6787,
    6788,
    6816,
    6802,
    6791,
    6803,
    6881,
    6792,
    6802,
    6790,
    6876,
    6782,
    6798,
    6786,
    6840,
    6780,
    6791,
    6813,
    6788,
    6801,
    6790,
    6773,
    6806,
    6796,
    6791,
    6798,
    6794,
    6798,
    6782,
    6788,
    6787,
    6835,
    6790,
    6784,
    6791,
    6791,
    6781,
    6795,
    6908,
    6800,
    6789,
    6802,
    6913,
    6803,
    6780,
    6792,
    6789,
    6795,
    6798,
    6853,
    6806,
    6801,
    6783,
    6795,
    6786,
    6797,
    6792,
    6793,
    6778,
    6800,
    6801,
    6790,
    6797,
    6797,
    6795,
    6798,
    6792,
    6782,
    6799,
    6793,
    6795,
    6798,
    6797,
    6788,
    6803,
    6790,
    6791,
    6815,
    6799,
    6787,
    6787,
    6797,
    6788,
    6810,
    6779,
    6799,
    6788,
    6837,
    6793,
    6789,
    6785,
    6798,
    6797,
    6788,
    6795,
    6795,
    6802,
    6801,
    6806,
    6780,
    6784,
    6857,
    6804,
    6797,
    6905,
    6791,
    6783,
    6942,
    6798,
    6783,
    6780,
    6895,
    6789,
    6788,
    6797,
    6789,
    6794,
    6790,
    6812,
    6787,
    6797,
    6770,
    6787,
    6787,
    6787,
    6793,
    6784,
    6780,
    6777,
    6790,
    6794,
    6784,
    6795,
    6797,
    6792,
    6784,
    6801,
    6787,
    6781,
    6798,
    6777,
    6815,
    6793,
    6798,
    6788,
    6877,
    6796,
    6790,
    6796,
    6784,
    6803,
    6863,
    6791,
    6792,
    6805,
    6806,
    6785,
    6775,
    6797,
    6785,
    6807,
    6830,
    6785,
    6788,
    6792,
    6773,
    6785,
    6795,
    6785,
    6801,
    6792,
    6892,
    6802,
    6786,
    6808,
    6785,
    6799,
    6796,
    6798,
    6799,
    6786,
    6846,
    6775,
    6776,
    6797,
    6785,
    6786,
    6783,
    6789,
    6792,
    6791,
    6777,
    6787,
    6783,
    6790,
    6788,
    6784,
    6791,
    6774,
    6794,
    6785,
    6784,
    6781,
    6792,
    6797,
    6785,
    6810,
    6792,
    6780,
    6780,
    6795,
    6780,
    6852,
    6781,
    6778,
    6785,
    6828,
    6771,
    6790,
    6785,
    6775,
    6748,
    6776,
    6774,
    6778,
    6834,
    6790,
    6782,
    6797,
    6786,
    6794,
    6792,
    6781,
    6790,
    6793,
    6786,
    6896,
    6782,
    6790,
    6792,
    6790,
    6784,
    6786,
    6793,
    6783,
    6781,
    6779,
    6774,
    6789,
    6792,
    6796,
    6779,
    6782,
    6787,
    6797,
    6780,
    6791,
    6780,
    6787,
    6780,
    6787,
    6782,
    6792,
    6789,
    6778,
    6786,
    6780,
    6787,
    6790,
    6780,
    6780,
    6786,
    6792,
    6832,
    6778,
    6784,
    6789,
    6786,
    6788,
    6779,
    6850,
    6787,
    6779,
    6782,
    6828,
    6789,
    6789,
    6778,
    6792,
    6793,
    6789,
    6746,
    6786,
    6783,
    6793,
    6755,
    6789,
    6785,
    6777,
    6787,
    6783,
    6794,
    6880,
    6786,
    6790,
    6914,
    6789,
    6795,
    6792,
    6795,
    6787,
    6792,
    6778,
    6775,
    6774,
    6789,
    6791,
    6782,
    6776,
    6780,
    6775,
    6786,
    6794,
    6786,
    6791,
    6785,
    6770,
    6783,
    6773,
    6777,
    6782,
    6779,
    6780,
    6782,
    6781,
    6798,
    6784,
    6794,
    6804,
    6791,
    6777,
    6801,
    6790,
    6792,
    6893,
    6773,
    6781,
    6771,
    6773,
    6790,
    6791,
    6782,
    6784,
    6780,
    6775,
    6777,
    6797,
    6742,
    6798,
    6790,
    6785,
    6801,
    6779,
    6777,
    6857,
    6771,
    6784,
    6895,
    6783,
    6788,
    6788,
    6786,
    6776,
    6777,
    6880,
    6790,
    6780,
    6813,
    6782,
    6787,
    6786,
    6770,
    6776,
    6770,
    6779,
    6786,
    6772,
    6774,
    6787,
    6795,
    6783,
    6786,
    6780,
    6772,
    6782,
    6777,
    6778,
    6772,
    6788,
    6777,
    6779,
    6789,
    6777,
    6774,
    6782,
    6787,
    6789,
    6787,
    6789,
    6778,
    6782,
    6877,
    6778,
    6788,
    6773,
    6851,
    6780,
    6792,
    6776,
    6778,
    6775,
    6773,
    6814,
    6783,
    6788,
    6777,
    6770,
    6784,
    6787,
    6780,
    6790,
    6787,
    6777,
    6861,
    6777,
    6781,
    6783,
    6882,
    6780,
    6776,
    6778,
    6787,
    6790,
    6790,
    6877,
    6784,
    6779,
    6791,
    6777,
    6820,
    6782,
    6781,
    6774,
    6788,
    6782,
    6780,
    6784,
    6779,
    6786,
    6783,
    6766,
    6783,
    6779,
    6773,
    6778,
    6782,
    6764,
    6775,
    6784,
    6777,
    6779,
    6783,
    6779,
    6790,
    6774,
    6779,
    6789,
    6776,
    6774,
    6782,
    6835,
    6790,
    6781,
    6778,
    6873,
    6784,
    6781,
    6774,
    6784,
    6779,
    6790,
    6781,
    6780,
    6777,
    6836,
    6800,
    6776,
    6791,
    6772,
    6781,
    6776,
    6786,
    6778,
    6782,
    6777,
    6827,
    6781,
    6783,
    6770,
    6773,
    6775,
    6774,
    6771,
    6822,
    6774,
    6776,
    6781,
    6825,
    6784,
    6770,
    6791,
    6784,
    6779,
    6778,
    6819,
    6781,
    6768,
    6770,
    6775,
    6764,
    6770,
    6773,
    6789,
    6768,
    6785,
    6777,
    6769,
    6786,
    6792,
    6780,
    6766,
    6784,
    6767,
    6776,
    6778,
    6784,
    6782,
    6792,
    6782,
    6789,
    6777,
    6782,
    6770,
    6773,
    6779,
    6778,
    6776,
    6777,
    6775,
    6772,
    6763,
    6785,
    6782,
    6847,
    6789,
    6782,
    6776,
    6775,
    6781,
    6773,
    6772,
    6773,
    6769,
    6782,
    6772,
    6780,
    6771,
    6858,
    6782,
    6785,
    6771,
    6783,
    6779,
    6783,
    6772,
    6785,
    6774,
    6798,
    6767,
    6781,
    6783,
    6781,
    6780,
    6768,
    6777,
    6776,
    6771,
    6772,
    6780,
    6771,
    6763,
    6764,
    6777,
    6772,
    6782,
    6771,
    6773,
    6774,
    6773,
    6771,
    6773,
    6783,
    6776,
    6764,
    6767,
    6771,
    6769,
    6769,
    6778,
    6774,
    6771,
    6781,
    6779,
    6767,
    6785,
    6775,
    6777,
    6786,
    6766,
    6785,
    6769,
    6856,
    6756,
    6772,
    6767,
    6787,
    6763,
    6823,
    6791,
  ]);

  // design a FIR filter low pass with cut frequency at 1Hz, the objective is,
  // remove the 10Hz sine wave signal,
  var fs = 30;
  var nyq = 0.5 * fs; // nyquist frequency,
  var fc = 1; // cut frequency 1Hz,
  var normal_fc = fc / nyq; // frequency normalization for digital filters,
  var numtaps = 30; // attenuation of the filter after cut frequency,

  // generation of the filter coefficients,
  var b = firwin(numtaps, Array([normal_fc]));
  //print('FIR');,
  //print(b);,

  //-------- Digital filter application -----------//,
  //print('digital filter application');,
  // Apply the filter on the signal using lfilter function,
  // lfilter uses direct form II transposed, for FIR filter,
  // the a coefficient is 1.0,
  //var sgFiltered = lfilter(b, Array([1.0]), sg);,
  var sgfiltered_RED = lfilter(b, Array([1.0]), RED);
  var sgfiltered_IR = lfilter(b, Array([1.0]), IR);

  // ------------------------------------IR signal processing------------------------
  var pk_IR = findtopPeaks(sgfiltered_IR, mindistance: 55);
  var troughs_IR = findlowtroughs(sgfiltered_IR, mindistance: 55);

  //fit a model that project pk_IR[0] to pk_IR[1]
  var u_x_IR = Array([]);
  var u_y_IR = Array([]);
  var l_x_IR = Array([]);
  var l_y_IR = Array([]);

  u_x_IR.add(0); //force u contains the last point of the filtered signal
  u_y_IR.add(sgfiltered_IR.first); //
  u_x_IR.addAll(pk_IR[0]);
  u_y_IR.addAll(pk_IR[1]);
  u_x_IR.add(sgfiltered_IR.length -
      1.0); //force u contains the last point of the filtered signal
  u_y_IR.add(sgfiltered_IR.last); //

  l_x_IR.add(0); //force u contains the last point of the filtered signal
  l_y_IR.add(sgfiltered_IR.first); //
  l_x_IR.addAll(troughs_IR[0]);
  l_y_IR.addAll(troughs_IR[1]);
  l_x_IR.add(sgfiltered_IR.length -
      1.0); //force u contains the last point of the filtered signal
  l_y_IR.add(sgfiltered_IR.last); //

  var q_u_IR = []; // the model for upper bound of IR signal
  var q_l_IR = []; // the model for lower bound of IR signal
  for (var k = 0; k < u_x_IR.length - 1; k++) {
    q_u_IR.addAll(
        linear_interp(u_x_IR[k], u_y_IR[k], u_x_IR[k + 1], u_y_IR[k + 1]));
  }
  for (var k = 0; k < l_x_IR.length - 1; k++) {
    q_l_IR.addAll(
        linear_interp(l_x_IR[k], l_y_IR[k], l_x_IR[k + 1], l_y_IR[k + 1]));
  }

  //print('---q_l_IR----');
  //print(q_l);
  //print('---q_u_IR----');
  // print(q_u_IR);
  // ------------------------------------RED signal processing------------------------
  var pk_RED = findtopPeaks(sgfiltered_RED, mindistance: 55);
  var troughs_RED = findlowtroughs(sgfiltered_RED, mindistance: 55);

  //fit a model that project pk_RED[0] to pk_RED[1]
  var u_x_RED = Array([]);
  var u_y_RED = Array([]);
  var l_x_RED = Array([]);
  var l_y_RED = Array([]);

  u_x_RED.add(0); //force u contains the last point of the filtered signal
  u_y_RED.add(sgfiltered_RED.first); //
  u_x_RED.addAll(pk_RED[0]);
  u_y_RED.addAll(pk_RED[1]);
  u_x_RED.add(sgfiltered_RED.length -
      1.0); //force u contains the last point of the filtered signal
  u_y_RED.add(sgfiltered_RED.last); //

  l_x_RED.add(0); //force u contains the last point of the filtered signal
  l_y_RED.add(sgfiltered_RED.first); //
  l_x_RED.addAll(troughs_RED[0]);
  l_y_RED.addAll(troughs_RED[1]);
  l_x_RED.add(sgfiltered_RED.length -
      1.0); //force u contains the last point of the filtered signal
  l_y_RED.add(sgfiltered_RED.last); //

  var q_u_RED = []; // the model for upper bound of IR signal
  var q_l_RED = []; // the model for lower bound of IR signal
  for (var k = 0; k < u_x_RED.length - 1; k++) {
    q_u_RED.addAll(
        linear_interp(u_x_RED[k], u_y_RED[k], u_x_RED[k + 1], u_y_RED[k + 1]));
  }
  for (var k = 0; k < l_x_RED.length - 1; k++) {
    q_l_RED.addAll(
        linear_interp(l_x_RED[k], l_y_RED[k], l_x_RED[k + 1], l_y_RED[k + 1]));
  }
//-----------------------------------calculate parameters for RR and SPO2 ----------------------------------------------
  var pp_RED = Array(q_u_RED.cast<double>()) - Array(q_l_RED.cast<double>());
  var pp_IR = Array(q_u_IR.cast<double>()) - Array(q_l_IR.cast<double>());
  print(sgfiltered_RED.length);
  //--------------------------------calculate RR------------------------------------------------
  var RR = (pp_RED / Array(q_l_RED.cast<double>())) /
      (pp_IR / Array(q_l_IR.cast<double>()));

  //---------------------------calculate SPO2------------------------------
  //SPO2=(-45.060*RR.^2)+30.354*RR+94.84;
  var SPO2 = Array.empty();
  SPO2 = arraySubToScalar(
      arrayMultiplyToScalar(arrayPow(RR, 2.0), -45.06) +
          arrayMultiplyToScalar(RR, 30.354),
      -94.84);

  print(SPO2);
}
